\documentclass[unicode,lefteqn]{beamer}
\usepackage{presentation}
% \usepackage{etex}
\usepackage{multicol}
\usepackage{bm}

\title[Классификация временных рядов]
    {Классификация временных рядов в пространстве параметров порождающих моделей}
\author[Карасиков Михаил]
    {\large Карасиков Михаил}
    \institute[МФТИ]{\large
    Московский физико-технический институт\\
    Факультет управления и прикладной математики\\
    Кафедра интеллектуальных систем\\
    \vspace{0.3cm}
    Научный руководитель: д.ф.-м.н. В.\,В.\,Cтрижов}

\date{\footnotesize{Москва, 2015\,г.}}

\begin{document}

\begin{titlepage}
  \thispagestyle{empty}
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Описание исследования}
\begin{block}{Исследуется}
Задача построения пространства признаков в задаче многоклассовой классификации временных рядов
\end{block}

\medskip
\textbf{Цели исследования:}
\begin{itemize}
  \item построение алгоритма многоклассовой классификации, использующего в качестве признаков временных рядов параметры моделей временных рядов и их распределения,
  \item обобщение методов классификации временных рядов, использующих явное признаковое описание,
  \item повышение качества решения задач классификации временных рядов.
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

% \begin{frame}{Исследуемый метод построения пространства признаков}
% \begin{block}{Предположение}
% Временной ряд~--- набор фрагментов, описывающихся некоторой случайной параметрической моделью.
% \end{block}

% \medskip
% Пространство признаков строится в $3$ шага:
% \begin{enumerate}
  % \item разбиение временного ряда на фрагменты,
  % \item извлечение признаков из каждого фрагмента,
  % \item оценка параметров распределения признаков фрагментов.
% \end{enumerate}

% \medskip
% Полученные параметры распределений служат признаками при классификации.

% % \medskip
% % Изложенный метод сравнивается с методом голосования,
% % где шаг \boxednumber{3} пропускается, а классификация происходит голосованием для фрагментов.

% \end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Литература}
\begin{itemize}
  \item Human activity recognition using smart phone embedded sensors: A linear dynamical systems method / W.\;Wang, H.\;Liu, L.\;Yu, F.\;Sun // Neural Networks (IJCNN), 2014 International Joint Conference on.— 2014.—July.— Pp. 1185–1190.
  \item Kwapisz,\;J.\;R. Activity recognition using cell phone accelerometers / J.\;R.\;Kwapisz, G.\;M.\;Weiss, S.\;A.\;Moore // SIGKDD Explor. Newsl.— 2011.—March.— Vol. 12, no. 2.— Pp. 74–82. http:
//doi.acm.org/10.1145/1964897.1964918.
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Постановка задачи}
\textbf{Дано:}
$X^\ell=\{x_1,\dots,x_\ell\}\subset X$~--- временные ряды,\\
\hspace*{35pt}$Y$~--- множество меток классов,\\
\hspace*{35pt}$\mathfrak{D}\subset X^\ell\times Y$~--- обучающая выборка.

\medskip
\textbf{Модель алгоритма классификации:} $a=b\circ \mathbf{f}\circ S,$
где\\
$S$~--- алгоритм фрагментации,\\
$\mathbf{f}$~--- признаковое описание набора фрагментов,\\
$b$~--- алгоритм многоклассовой классификации.

\medskip
\textbf{Метод обучения} $\mu:\;(X\times Y)^{m}\to A$

выбирается по~скользящему контролю:
\[
\mu^* = \argmin_{\mu}CV(\mu,\mathfrak{D}).
\]
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Разбиение временного ряда на фрагменты}
\begin{block}{Определения}
\begin{itemize}
  \item Временной ряд:~$x=[x^{(1)},\dots,x^{(t)}]\in X$.
  \item Фрагмент временного ряда:~$s=[x^{(i_1)},\dots,x^{(i_k)}],$
  \hspace*{137pt}где $1\leq i_1\leq\dots\leq i_k\leq t$.
\end{itemize}
%\textbf{Замечание:} фрагмент~--- тоже временной ряд.
\end{block}

Пусть $\mathbf{S}(x)$~--- множество всех фрагментов временного ряда~$x$.

Тогда алгоритм фрагментации есть отображение~$S: x\mapsto \mathbf{S}(x)$.

\medskip
\textbf{Примеры:}
\begin{itemize}
  \item тождественное отображение
    \[
    S:\;x\mapsto \{x\},
    \]
  \item сегментация
    \[
    S:\;x\mapsto \{s^{(1)},\dots,s^{(p)}\},
    \text{ где } x=(s^{(1)}, \dots, s^{(p)}).
    \]
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Модель фрагмента временного ряда}
Каждый фрагмент есть временной ряд:
$\mathbf{S}(x)\subset X.$

\medskip
Фрагменты временных рядов описывается моделями вида
\[
g:\;\mathbb{R}^d\times X\rightarrow X.
\]
Параметры настроенной модели определяются по формуле
\[
\mathbf{w}_g(x) =
\argmin_{\mathbf{w}\in \mathbb{R}^d} \rho\left(g(\mathbf{w},x), x\right).
\]
\begin{block}{Примеры.}
\begin{itemize}
  \item Линейная регрессионная модель
  \item Авторегрессионная модель (AR)
  \item Модель скользящего среднего (MA)
  \item Фурье"=модель
  \item Вейвлет"=модель
\end{itemize}
\end{block}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Параметры моделей фрагментов}
Предлагаются две схемы решения исходной задачи.
\begin{itemize}
  \item Принцип голосования: обучение алгоритма $b$ на~новой обучающей выборке~$\hat{\mathfrak{D}}$, составленной из фрагментов временных рядов исходной обучающей выборки~$\mathfrak{D}$:
  \[
  \hat{\mathfrak{D}}=\left\{(\mathbf{w}_g(s),y):\;(x,y)\in\mathfrak{D},\,s\in S(x)\right\}
  \]
  и последующая классификация
  \[
  a(x;S,g,b)=h\left(\left\{b(\mathbf{w}_g(s)):\;s\in S(x)\right\}\right).
  \]
  \item Классификация в пространстве параметров распределений параметров моделей.
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Классификация в пространстве параметров распределений параметров моделей}
$\mathbf{w}_g\circ S$ дает множество наборов параметров модели:
\[
W(x;S,g)=\left\{\mathbf{w}_g(s):\;s\in S(x)\right\}.
\]
\begin{block}{Гипотеза порождения временного ряда}
Фрагменты временного ряда~$s\in S(x)$ описываются моделью~$g(\mathbf{w}, s)$ со случайными параметрами~$\mathbf{w}$ из параметрического семейства распределений~$\left\{\mathsf{P}_{\bm{\theta}}\right\}_{\bm{\theta}\in\Theta}$.
\end{block}

\textbf{Предлагается} в качестве признакового описания временного ряда использовать оценку вектора параметров распределения:
\[
\mathbf{f}(x;S,g,\Theta)=\argmax_{\bm{\theta}\in\Theta}\mathcal{L}\left(\bm{\theta}|W(x;S,g)\right).
\]
Тогда получим алгоритм классификации временных рядов:
\[
a(x) = b(\mathbf{f}(x;S,g,\Theta)).
\]
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Сведение задачи многоклассовой классификации к бинарным}
\begin{itemize}
  \item One"~vs"~All approach:
  \[
  a(x)=\argmax_{i=1,\dots ,N} f_i(x),\quad
  f_i(x) = \begin{cases}
    \geq 0, & \text{если } y(x) = i,\\
       < 0, & \text{если } y(x)\neq i.
  \end{cases}
  \]
  \item One"~vs"~One approach:
  \[
  a(x) = \argmax_{i=1,\dots ,N} \sum_{\substack{j=1,\dots ,N\\ j\neq i}} f_{ij}(x),\quad
  f_{ij}(x) = \begin{cases}
    +1, & \text{если } y(x)=i,\\
    -1, & \text{если } y(x)=j.
  \end{cases}
  \]
  \item Error"=Correcting Output Codes approach:
  \[
  a(x) = \argmin_{i=1,\dots,N} \sum_{j=1}^F L(M^i_j f_j(x)),
  \]
  где~$M\in \left\{-1,0,+1\right\}^{N{\times}F}$~--- матрица, строки которой состоят из~кодов меток классов~$Y$, а $L$~--- функция потерь.
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Бинарная классификация: $Y=\{\pm 1\}$}
Пусть $\mathbf{f}(x)\in\mathbb{R}^n$~--- признаковое описание временного ряда $x$.

\medskip
Тогда для решения задачи бинарной классификации временных рядов необходимо задать метод обучения~$\mu_b:\;\mathfrak{D}\mapsto f$.

\medskip
Например, для SVM с линейным ядром
\[
f(x; \bm w) = \sign(\bm{w}^{\mathsf{T}}\mathbf{f}(x) - w_0),
\]
где $\bm w$ и $w_0$~--- решения оптимизационной задачи
\[
\frac{1}{2C} \|\bm w\|^2 + \sum_{(x,y)\in\mathfrak{D}}\left(1-y(\bm{w}^\mathsf{T}\mathbf{f}(x) - w_0)\right)_+ \to \min_{\bm w\in\mathbb{R}^n,\;w_0\in\mathbb{R}}.
\]
% Эксперименты показали достаточную эффективность классификаторов
% \begin{itemize}
  % \item Машина опорных векторов (SVM)
  % \item Регуляризованная логистическая регрессия (RLR)
% \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

% \begin{frame}{}
% \algorithmicrequire{$\ \mathfrak{D},\,g,\,\mu$.}

% \algorithmicensure{$\ a$.}
% \BEGIN
  % \STATE{$d(s):=0$}
  % \FORALL{$v \in V\backslash\{s\}$}
    % \STATE{$d(v):=\infty$}\\
    % \STATE{$pred(v):=\text{NULL}$}
  % \ENDFOR

  % \FOR{$i:=1$ to $|V|-1$}
    % \FORALL{$(u,v)\in E$}
      % \IF{$d(u) + w_{(u,v)} < d(v)$}
        % \STATE{$d(v):=d(u) + w_{(u,v)}$}
        % \STATE{$pred(v):=u$}
      % \ENDIF
    % \ENDFOR
  % \ENDFOR
% \END
% \end{frame}

%%%%%%%%%%%%%%%%%%%%

% \begin{frame}{Иллюстрация проблемы}
% Датасет USC-HAD содержит показания акселерометра для 12 видов человеческой активности:
% \begin{multicols}{2}
% \begin{enumerate}
  % \item walk forward
  % \item walk left
  % \item walk right
  % \item go upstairs
  % \item go downstairs
  % \item run forward
  % \item jump up and down
  % \item sit and fidget
  % \item stand
  % \item sleep
  % \item elevator up
  % \item elevator down
% \end{enumerate}
% \end{multicols}

% Выборка содержит примерно по $70$ шести"=компонентных временных ряда для каждого класса, а средняя длина временного ряда порядка~$3300$.

% \textbf{Задача:} многоклассовая классификация.

% \end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Приложение}
В качестве приложения рассматривается задача классификации физической активности по данным с акселерометра.
\begin{block}{Особенности}
\begin{itemize}
  \item Классификация физической активности людей с разными физическими характеристиками
  \item Форма временного ряда существенно зависит от характеристик человека
  \item Во временных рядах допускаются аномалии
\end{itemize}
\end{block}

\begin{block}{Предположение}
Форма временного ряда сохраняются для конкретного человека и типа физической активности
\end{block}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Вычислительный эксперимент}
\textbf{Цели эксперимента:}
\begin{enumerate}
  \item демонстрация качества предлагаемого алгоритма
  \item изучение зависимости качества классификации от
  \begin{itemize}
    \item алгоритма фрагментации
    \item модели фрагмента
  \end{itemize}
\end{enumerate}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Dataset WISDM}
Временной ряд из трех компонент: $\mathbf{x} = [x_t^k]^{k=1,2,3}.$
\begin{block}{Признаки (по 31 на каждый временной ряд)}
\begin{enumerate}
  \item $7$ коэффициентов авторегрессии~$AR(6):$
  \[
  \argmin_{w_0,\dots,w_6}\sum_{t}\left(x_t^k - w_0 - \sum_{i=1}^{6} w_i x^{k}_{t-i}\right)^2.
  \]
  \item Статистики:
  \begin{multicols}{2}
  \begin{itemize}
    \item $\bar{x}^k=\frac{1}{T}\sum_{t}x_t^k,$
    \item $\frac{1}{T}\sum_{t}|x_t^k - \bar{x}^k|,$
    \item $\sqrt{\frac{1}{T-1}\sum_{t}(x_t^k -\bar{x}^k)^2},$
    \item $\frac{1}{T}\sum_{t}\|\mathbf{x}_t\|.$
  \end{itemize}
  \end{multicols}
\end{enumerate}
\end{block}
Без фрагментации, классификатор RBF SVM ($\gamma=0.8$, $C=4$), подход One-vs-All, $50$ случайных разбиений в отношении $7$ к $3$.
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Dataset WISDM: результаты}
\begin{minipage}{0.7\textwidth}
\includegraphics[width=\linewidth]{{../pics/Accuracy_Dataset_WISDM_nSplits_50_rate_0.7_approach_OneVsAll_decoding_LLB_classifier_SVM}.eps}
\end{minipage}
\begin{minipage}{0.25\textwidth}
\textbf{Class labels:}
\begin{enumerate}
  \item Jogging
  \item Walking
  \item Upstairs
  \item Downstairs
  \item Sitting
  \item Standing
\end{enumerate}
\end{minipage}
\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Dataset USC-HAD}

\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Dataset USC-HAD: сегментация}

\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Dataset USC-HAD: голосование}

\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Dataset USC-HAD: распределения}

\end{frame}

%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Заключение}
\end{frame}
\begin{frame}{Результаты, выносимые на защиту}
\begin{itemize}
  \item Предложен алгоритмы построения пространства признаков
  \smallskip
  \item Предложен алгоритм классификации временных рядов
  \medskip
  \item Выполнена программная реализация и проведены численные эксперименты, показавшие повышения качества решения задачи классификации
\end{itemize}
\end{frame}

\end{document}